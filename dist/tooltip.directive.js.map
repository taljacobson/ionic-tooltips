{"version":3,"sources":["../src/tooltip.directive.ts"],"names":[],"mappings":"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","file":"tooltip.directive.js","sourceRoot":"","sourcesContent":["import {\r\n  Directive, ElementRef, Input, ApplicationRef, ComponentFactoryResolver,\r\n  ViewContainerRef, ComponentRef\r\n} from '@angular/core';\r\nimport { Platform } from 'ionic-angular';\r\nimport { TooltipBox } from './tooltip-box.component';\r\n\r\n\r\nexport class Tooltip {\r\n\r\n   tooltip: string;\r\n\r\n   positionV: string;\r\n\r\n   positionH: string;\r\n\r\n   event: 'press' | 'click' = 'click';\r\n\r\n  \r\n  set navTooltip(val: boolean) {\r\n    this._navTooltip = typeof val !== 'boolean' || val != false;\r\n  }\r\n  get navTooltip(): boolean {\r\n    return this._navTooltip;\r\n  }\r\n\r\n  \r\n  set arrow(val: boolean) {\r\n    this._arrow = typeof val !== 'boolean' || val != false;\r\n  }\r\n  get arrow(): boolean { return this._arrow; }\r\n\r\n   duration: number = 3000;\r\n\r\n  private _arrow: boolean = false;\r\n  private _navTooltip: boolean = false;\r\n  private tooltipElement: ComponentRef<TooltipBox>;\r\n  private tooltipTimeout: any;\r\n  private canShow: boolean = true;\r\n\r\n  constructor(\r\n      private el: ElementRef\r\n      , private appRef: ApplicationRef\r\n      , private platform: Platform\r\n      , private _componentFactoryResolver: ComponentFactoryResolver\r\n  ) {}\r\n\r\n  /**\r\n   * Handles the click/press event and shows a tooltip.\r\n   * If a tooltip already exists, it will just reset it's timer.\r\n   */\r\n  trigger() {\r\n    if (!this.canShow) return;\r\n\r\n    if (this.tooltipElement) {\r\n      this._resetTimer();\r\n    } else {\r\n      this.showTooltip();\r\n    }\r\n  }\r\n\r\n\r\n  /**\r\n   * Creates a new tooltip component and adjusts it's properties to show properly.\r\n   */\r\n  showTooltip() {\r\n\r\n    this._createTooltipComponent();\r\n\r\n    const tooltipComponent: TooltipBox = this.tooltipElement.instance;\r\n\r\n    tooltipComponent.text = this.tooltip;\r\n    tooltipComponent.init.then(() => {\r\n\r\n      const tooltipPosition = this._getTooltipPosition();\r\n\r\n      tooltipComponent.posLeft = tooltipPosition.left;\r\n      tooltipComponent.posTop = tooltipPosition.top;\r\n\r\n      tooltipComponent.fadeState = 'visible';\r\n\r\n      if (this.arrow) {\r\n        let arrowPosition;\r\n        if (this.positionV === 'top') {\r\n          arrowPosition = 'bottom';\r\n        } else if (this.positionV === 'bottom') {\r\n          arrowPosition = 'top';\r\n        } else if (this.positionH === 'left') {\r\n          arrowPosition = 'right';\r\n        } else {\r\n          arrowPosition = 'left';\r\n        }\r\n        tooltipComponent.arrow = arrowPosition;\r\n      }\r\n\r\n      this.tooltipTimeout = setTimeout(this._removeTooltip.bind(this), this.duration);\r\n\r\n    });\r\n\r\n  }\r\n\r\n  private _createTooltipComponent() {\r\n    let\r\n        viewport: ViewContainerRef = (<any>this.appRef.components[0])._component._viewport,\r\n        componentFactory = this._componentFactoryResolver.resolveComponentFactory(TooltipBox);\r\n\r\n    this.tooltipElement = viewport.createComponent(componentFactory);\r\n  }\r\n\r\n  private _getTooltipPosition() {\r\n    const\r\n        tooltipNativeElement: HTMLElement = this.tooltipElement.instance.getNativeElement(),\r\n        el: HTMLElement = this.el.nativeElement,\r\n        rect: ClientRect = el.getBoundingClientRect();\r\n\r\n    let positionLeft: number, positionTop: number, spacing: number = 10;\r\n\r\n    if (this.navTooltip) {\r\n      this.positionV = 'bottom';\r\n      this.arrow = false;\r\n      spacing = 20;\r\n    }\r\n\r\n\r\n    if (this.positionH === 'right') {\r\n      positionLeft = rect.right + spacing;\r\n    } else if (this.positionH === 'left') {\r\n      positionLeft = rect.left - spacing - tooltipNativeElement.offsetWidth;\r\n    } else if (this.navTooltip) {\r\n      positionLeft = rect.left + el.offsetWidth / 2\r\n    } else {\r\n      positionLeft = rect.left;\r\n    }\r\n\r\n    if (this.positionV === 'top') {\r\n      positionTop = rect.top - spacing - tooltipNativeElement.offsetHeight;\r\n    } else if(this.positionV === 'bottom') {\r\n      positionTop = rect.bottom + spacing;\r\n    } else {\r\n      positionTop = (rect.top + el.offsetHeight / 2) - tooltipNativeElement.offsetHeight / 2;\r\n    }\r\n\r\n    if (positionLeft + tooltipNativeElement.offsetWidth + spacing > this.platform.width()) {\r\n      positionLeft = this.platform.width() - tooltipNativeElement.offsetWidth - spacing;\r\n    } else if (positionLeft + tooltipNativeElement.offsetWidth - spacing < 0) {\r\n      positionLeft = spacing;\r\n    }\r\n\r\n    return {\r\n      left: positionLeft,\r\n      top: positionTop\r\n    };\r\n  }\r\n\r\n  private _removeTooltip() {\r\n    if (!this.tooltipElement) {\r\n      this.tooltipElement = undefined;\r\n      this.tooltipTimeout = undefined;\r\n      return;\r\n    }\r\n\r\n    this.tooltipElement.instance.fadeState = 'invisible';\r\n\r\n    this.canShow = false;\r\n\r\n    // wait for animation to finish then clear everything out\r\n    setTimeout(() => {\r\n      this.tooltipElement.destroy();\r\n      this.tooltipElement = undefined;\r\n      this.tooltipTimeout = undefined;\r\n      this.canShow = true;\r\n    }, 300);\r\n  }\r\n\r\n  private _resetTimer() {\r\n    clearTimeout(this.tooltipTimeout);\r\n    this.tooltipTimeout = setTimeout(this._removeTooltip.bind(this), this.duration);\r\n  }\r\n\r\nstatic decorators: DecoratorInvocation[] = [\n{ type: Directive, args: [{\r\n  selector: '[tooltip]',\r\n  host: {\r\n    '(press)': 'event === \"press\" && trigger()',\r\n    '(click)': 'event === \"click\" && trigger()',\r\n      '(mouseenter)':'event === \"click\" && trigger()'\r\n  }\r\n}, ] },\n];\n/** @nocollapse */\nstatic ctorParameters: () => ({type: any, decorators?: DecoratorInvocation[]}|null)[] = () => [\n{type: ElementRef, },\n{type: ApplicationRef, },\n{type: Platform, },\n{type: ComponentFactoryResolver, },\n];\nstatic propDecorators: {[key: string]: DecoratorInvocation[]} = {\n'tooltip': [{ type: Input },],\n'positionV': [{ type: Input },],\n'positionH': [{ type: Input },],\n'event': [{ type: Input },],\n'navTooltip': [{ type: Input },],\n'arrow': [{ type: Input },],\n'duration': [{ type: Input },],\n};\n}\r\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}